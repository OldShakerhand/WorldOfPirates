<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World of Pirates</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="game-container">
        <canvas id="gameCanvas"></canvas>
    </div>

    <!-- Name Input Overlay -->
    <div id="nameInputOverlay">
        <div id="nameInputContent">
            <h1>‚öì World of Pirates ‚öì</h1>
            <p>Enter your captain's name to set sail!</p>
            <input type="text" id="playerNameInput" placeholder="Captain Name" maxlength="20" autocomplete="off">
            <div id="nameError" style="display: none;"></div>

            <!-- Custom spawn for testing -->
            <div style="margin: 10px 0; padding: 8px; background: rgba(0,0,0,0.3); border-radius: 3px;">
                <label style="font-size: 11px; color: #aaa;">Custom Spawn (testing only):</label><br>
                <input type="number" id="spawnX" placeholder="X" style="width: 80px; margin: 3px; padding: 4px;">
                <input type="number" id="spawnY" placeholder="Y" style="width: 80px; padding: 4px;">
            </div>

            <button id="setSailBtn">Set Sail! üè¥‚Äç‚ò†Ô∏è</button>
            <p class="hint">3-20 characters (letters, numbers, spaces)</p>
        </div>
    </div>

    <!-- Chat Panel (Kill Feed) -->
    <div id="chatPanel">
        <div id="chatMessages"></div>
    </div>

    <!-- Harbor UI Overlay -->
    <div id="harborUI" style="display: none;">
        <div id="harborContent">
            <h2 id="harborTitle">üè¥‚Äç‚ò†Ô∏è Harbor</h2>
            <div id="harborInfo">
                <h3>Your Fleet:</h3>
                <div id="fleetList"></div>

                <h3>Change Flagship:</h3>
                <!-- IMPORTANT: Ship stats must match src/server/game/ShipClass.js -->
                <!-- When updating ship classes, update these option texts to reflect current stats -->
                <select id="shipSelector">
                    <option value="SLOOP">Sloop (2 cannons/side, 131 speed)</option>
                    <option value="BARQUE">Barque (3 cannons/side, 120 speed)</option>
                    <option value="FLUYT">Fluyt (4 cannons/side, 115 speed)</option>
                    <option value="MERCHANT">Merchant (5 cannons/side, 104 speed)</option>
                    <option value="FRIGATE">Frigate (6 cannons/side, 112 speed)</option>
                    <option value="SPANISH_GALLEON">Spanish Galleon (8 cannons/side, 100 speed)</option>
                    <option value="WAR_GALLEON">War Galleon (12 cannons/side, 91 speed)</option>
                </select>
                <button id="switchShipBtn" onclick="switchFlagship()">Switch Flagship</button>

                <div id="harborActions">
                    <button id="repairBtn" onclick="repairShip()">Repair Flagship</button>
                    <button id="closeBtn" onclick="closeHarbor()">Set Sail</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Controls Legend (Temporary - for testing) -->
    <div id="controlsLegend">
        <h3>‚öì Controls</h3>

        <div class="legend-section">
            <strong>Movement</strong>
            <div class="control-item"><kbd>A</kbd> / <kbd>D</kbd> - Turn left/right</div>
            <div class="control-item"><kbd>W</kbd> / <kbd>S</kbd> - Raise/lower sails</div>
            <div class="control-item-note">Sail levels: None ‚Üí Half ‚Üí Full</div>
        </div>

        <div class="legend-section">
            <strong>Combat</strong>
            <div class="control-item"><kbd>Q</kbd> - Fire port (left) broadside</div>
            <div class="control-item"><kbd>E</kbd> - Fire starboard (right) broadside</div>
        </div>

        <div class="legend-section">
            <strong>Harbor</strong>
            <div class="control-item"><kbd>H</kbd> - Dock in harbor</div>
            <div class="control-item-note">Get new ships, repair, switch flagship</div>
        </div>

        <div class="legend-section">
            <strong>Debug (Testing)</strong>
            <div class="control-item"><kbd>P</kbd> - Spawn pirate NPC</div>
            <div class="control-item"><kbd>N</kbd> - Spawn merchant NPC</div>
            <div class="control-item"><kbd>T</kbd> - Teleport to harbor</div>
        </div>

        <div class="legend-section">
            <strong>Missions (Testing)</strong>
            <div class="control-item"><kbd>1</kbd> - Sail to harbor</div>
            <div class="control-item"><kbd>2</kbd> - Stay in area (10s)</div>
            <div class="control-item"><kbd>3</kbd> - Defeat 3 NPCs</div>
            <div class="control-item"><kbd>4</kbd> - Escort trader</div>
        </div>

        <div class="legend-section">
            <strong>Wind Mechanics</strong>
            <div class="control-item-note">Speed varies by wind direction:</div>
            <div class="control-item-note">‚Ä¢ Tailwind (behind): Fastest</div>
            <div class="control-item-note">‚Ä¢ Beam reach (side): Medium</div>
            <div class="control-item-note">‚Ä¢ Headwind (front): Slowest</div>
        </div>
    </div>



    <script src="/socket.io/socket.io.js"></script>
    <!-- DEBUG: Harbor teleport system - REMOVE BEFORE PRODUCTION -->
    <script src="js/harbor_teleport_debug.js"></script>
    <script src="js/tilemap_debug.js"></script>
    <!-- DEBUG: Minimap visualization - REMOVE BEFORE PRODUCTION -->
    <script src="js/minimap_debug.js"></script>
    <!-- Visual Adapter Layer - Client-side visual enhancements -->
    <script src="js/visual_adapter.js"></script>
    <script src="js/WakeRenderer.js"></script>
    <script src="js/game.js"></script>
    <script src="js/client.js"></script>
</body>

</html>